# üöÄ Tracker KPR - Render Deployment Guide

## Quick Deployment Checklist

### Prerequisites
- ‚úÖ GitHub repository with code pushed
- ‚úÖ MongoDB Atlas account and cluster
- ‚úÖ Render.com account (free)
- ‚úÖ GitHub OAuth app created
- ‚úÖ Google Gemini API key

---

## Step 1: Prepare MongoDB Atlas (5 minutes)

1. Go to [MongoDB Atlas](https://www.mongodb.com/cloud/atlas)
2. Create a FREE cluster (M0 tier)
3. Create database user:
   - Username: `tracker_user`
   - Password: (generate secure password, save it)
4. Network Access ‚Üí Add IP Address ‚Üí **Allow access from anywhere** (`0.0.0.0/0`)
5. Get connection string:
   ```
   mongodb+srv://tracker_user:YOUR_PASSWORD@cluster0.xxxxx.mongodb.net/trackerdemo?retryWrites=true&w=majority
   ```

---

## Step 2: Update GitHub OAuth App (2 minutes)

You already have a GitHub OAuth app. Update it for production:

1. Go to https://github.com/settings/developers
2. Find your OAuth app or create new one
3. Update settings:
   - **Homepage URL**: `https://tracker-kpr-frontend.onrender.com` (update after deployment)
   - **Authorization callback URL**: `https://tracker-kpr-api.onrender.com/api/auth/github/callback`
4. Save **Client ID** and **Client Secret** (you'll need them)

Current OAuth App:
- Client ID: `Ov23lipFpzARkGCA9mVF`
- Client Secret: `3af2e27fe65c48025e12e72a895550fb63b4187c`

---

## Step 3: Prepare Secrets (2 minutes)

You'll need these secrets for Render deployment:

### Required Secrets:
```bash
# 1. MongoDB URI (from Step 1)
MONGODB_URI=mongodb+srv://tracker_user:YOUR_PASSWORD@cluster0.xxxxx.mongodb.net/trackerdemo?retryWrites=true&w=majority

# 2. GitHub OAuth (from Step 2)
GITHUB_CLIENT_ID=Ov23lipFpzARkGCA9mVF
GITHUB_CLIENT_SECRET=3af2e27fe65c48025e12e72a895550fb63b4187c

# 3. Gemini AI API Key (you already have this)
GEMINI_API_KEY=AIzaSyBb3cD0P9rjZYZ_v2Z6f4B06LTUBh_iIc4
```

### Auto-generated by Render:
- `JWT_SECRET` (auto-generated)
- `SESSION_SECRET` (auto-generated)
- `ENCRYPTION_KEY` (auto-generated)

---

## Step 4: Push to GitHub (1 minute)

```bash
cd "/Users/sachin/Downloads/Project/Tracker KPR"

# Ensure all changes are committed
git add .
git commit -m "Update render.yaml for deployment"
git push origin main
```

---

## Step 5: Deploy on Render (10 minutes)

### A. Create Services from Blueprint

1. **Login to Render**: https://render.com/
2. **New** ‚Üí **Blueprint**
3. **Connect GitHub repository**: `Fresh-MC/Tracker`
4. Render will detect `render.yaml` automatically
5. Click **Apply** (this creates 2 services: API + Frontend)

### B. Configure API Service Secrets

1. Go to **Dashboard** ‚Üí **tracker-kpr-api** service
2. Click **Environment** tab
3. Add these secret environment variables:

   | Key | Value | Notes |
   |-----|-------|-------|
   | `MONGODB_URI` | `mongodb+srv://tracker_user:PASSWORD@...` | From Step 1 |
   | `GITHUB_CLIENT_ID` | `Ov23lipFpzARkGCA9mVF` | From Step 2 |
   | `GITHUB_CLIENT_SECRET` | `3af2e27fe65c48025e12e72a895550fb63b4187c` | From Step 2 |
   | `GEMINI_API_KEY` | `AIzaSyBb3cD0P9rjZYZ_v2Z6f4B06LTUBh_iIc4` | Your Gemini key |

4. Click **Save Changes**

### C. Get Your Deployment URLs

After deployment completes (~5-10 minutes), you'll get:

- **API URL**: `https://tracker-kpr-api.onrender.com`
- **Frontend URL**: `https://tracker-kpr-frontend.onrender.com`

---

## Step 6: Update Cross-Service URLs (5 minutes)

### A. Update API Service

1. Go to **tracker-kpr-api** ‚Üí **Environment**
2. Update this variable:
   - `FRONTEND_URL` = `https://tracker-kpr-frontend.onrender.com`
3. Update this variable:
   - `GITHUB_CALLBACK_URL` = `https://tracker-kpr-api.onrender.com/api/auth/github/callback`
4. **Save Changes** ‚Üí Service will auto-redeploy

### B. Update Frontend Service

1. Go to **tracker-kpr-frontend** ‚Üí **Environment**
2. Update this variable:
   - `VITE_API_URL` = `https://tracker-kpr-api.onrender.com`
3. **Save Changes** ‚Üí Service will auto-redeploy

### C. Update GitHub OAuth App (Final)

1. Go back to https://github.com/settings/developers
2. Update your OAuth app:
   - **Homepage URL**: `https://tracker-kpr-frontend.onrender.com`
   - **Authorization callback URL**: `https://tracker-kpr-api.onrender.com/api/auth/github/callback`
3. **Update application**

---

## Step 7: Verify Deployment (2 minutes)

### Test API Health
```bash
curl https://tracker-kpr-api.onrender.com/api/health
```

Expected response:
```json
{
  "status": "ok",
  "timestamp": "2025-10-24T...",
  "environment": "production"
}
```

### Test Frontend
Visit: https://tracker-kpr-frontend.onrender.com

You should see the login page.

### Test GitHub OAuth Login
1. Click "Login with GitHub"
2. Authorize the app
3. You should be redirected back and logged in

---

## üéâ Deployment Complete!

Your application is now live at:
- **Frontend**: https://tracker-kpr-frontend.onrender.com
- **API**: https://tracker-kpr-api.onrender.com

---

## ‚ö†Ô∏è Important Notes

### Free Tier Limitations
- **Services spin down after 15 minutes of inactivity**
- First request after spin-down takes ~30-60 seconds
- **Solution**: Upgrade to Starter plan ($7/month per service) for always-on services

### Security Recommendations
1. **Rotate MongoDB password** - use a new strong password for production
2. **Generate new secrets** for JWT_SECRET, SESSION_SECRET, ENCRYPTION_KEY
3. **Monitor API usage** in Render dashboard
4. **Set up custom domain** (optional) in Render settings

### Auto-Deploy
- Render auto-deploys on every push to `main` branch
- To disable: Go to service ‚Üí Settings ‚Üí Auto-Deploy ‚Üí Off

---

## üêõ Troubleshooting

### Issue: "Service Unavailable" or 502 Error
**Solution**: 
1. Check service logs: Dashboard ‚Üí Service ‚Üí Logs
2. Verify all environment variables are set correctly
3. Check MongoDB Atlas IP whitelist includes `0.0.0.0/0`

### Issue: GitHub OAuth Fails
**Solution**:
1. Verify `GITHUB_CALLBACK_URL` matches GitHub OAuth app settings
2. Check `GITHUB_CLIENT_ID` and `GITHUB_CLIENT_SECRET` are correct
3. Ensure `FRONTEND_URL` is set correctly in API service

### Issue: AI Assistant Returns 500 Error
**Solution**:
1. Verify `GEMINI_API_KEY` is set correctly
2. Check Gemini API quota/billing status
3. Check service logs for specific error

### Issue: CORS Errors in Browser
**Solution**:
1. Verify `FRONTEND_URL` in API service matches actual frontend URL
2. Ensure `VITE_API_URL` in frontend matches actual API URL
3. Clear browser cache and cookies

---

## üìä Monitoring

### View Logs
1. Go to Dashboard ‚Üí Service
2. Click **Logs** tab
3. Filter by time range or search terms

### View Metrics
1. Go to Dashboard ‚Üí Service
2. Click **Metrics** tab
3. View CPU, Memory, Request rate

---

## üîÑ Making Updates

### Deploy Code Changes
```bash
# Make your changes
git add .
git commit -m "Your update message"
git push origin main
```

Render will automatically build and deploy.

### Manual Deploy
1. Go to Dashboard ‚Üí Service
2. Click **Manual Deploy** ‚Üí **Deploy latest commit**

---

## üí∞ Cost Optimization

### Current Setup (FREE)
- API Service: Free tier
- Frontend Service: Free tier
- MongoDB: Atlas M0 Free tier
- **Total**: $0/month

### Recommended Production Setup ($14/month)
- API Service: Starter tier ($7/month) - always on
- Frontend Service: Free tier (static sites are fast)
- MongoDB: Atlas M0 Free tier
- **Total**: $7/month

### Premium Setup ($21+/month)
- API Service: Starter tier ($7/month)
- Frontend Service: Starter tier ($7/month)
- MongoDB: Atlas M2 Shared tier ($9/month) - better performance
- **Total**: $23/month

---

## üéØ Next Steps

1. ‚úÖ Test all features thoroughly
2. ‚úÖ Set up error monitoring (Sentry, optional)
3. ‚úÖ Configure custom domain (optional)
4. ‚úÖ Add team members and test RBAC
5. ‚úÖ Monitor performance and logs
6. ‚úÖ Consider upgrading API service to Starter tier

---

## üìû Support

- **Render Documentation**: https://render.com/docs
- **MongoDB Atlas Support**: https://docs.atlas.mongodb.com/
- **Project Issues**: https://github.com/Fresh-MC/Tracker/issues

---

**Deployment Time**: ~25 minutes total
**Difficulty**: Easy
**Cost**: FREE (or $7/month for production)

Good luck with your deployment! üöÄ
